# å‰ç«¯æ‰“åŒ…éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

ç¾å›¢å•†å“ä¸Šä¼ å·¥å…·å‰ç«¯æ”¯æŒä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼š
1. **Web åº”ç”¨** - éƒ¨ç½²åˆ° Web æœåŠ¡å™¨ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®
2. **æ¡Œé¢åº”ç”¨** - æ‰“åŒ…æˆ Electron åº”ç”¨ï¼Œç‹¬ç«‹è¿è¡Œ

---

## ğŸŒ æ–¹å¼ 1ï¼šWeb åº”ç”¨æ‰“åŒ…

### æ­¥éª¤ 1ï¼šè¿è¡Œæ‰“åŒ…è„šæœ¬

```bash
# Windows
build-frontend.bat

# æˆ–æ‰‹åŠ¨æ‰§è¡Œ
cd meituan-frontend
npm install
npm run build
```

### æ­¥éª¤ 2ï¼šéªŒè¯æ„å»ºè¾“å‡º

æ„å»ºå®Œæˆåï¼Œæ£€æŸ¥ `meituan-frontend/dist` ç›®å½•ï¼š

```
dist/
â”œâ”€â”€ index.html          # ä¸»é¡µé¢
â”œâ”€â”€ assets/             # é™æ€èµ„æºï¼ˆJSã€CSSã€å›¾ç‰‡ï¼‰
â”‚   â”œâ”€â”€ index-xxx.js
â”‚   â”œâ”€â”€ index-xxx.css
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

### æ­¥éª¤ 3ï¼šéƒ¨ç½²åˆ°æœåŠ¡å™¨

#### é€‰é¡¹ Aï¼šä½¿ç”¨ Nginx

1. **ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼š**
```bash
# å‹ç¼© dist ç›®å½•
cd meituan-frontend
tar -czf dist.tar.gz dist/

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp dist.tar.gz root@106.55.102.48:/opt/meituan/

# SSH ç™»å½•æœåŠ¡å™¨
ssh root@106.55.102.48
cd /opt/meituan/
tar -xzf dist.tar.gz
```

2. **é…ç½® Nginxï¼š**
```nginx
server {
    listen 80;
    server_name your-domain.com;  # æˆ–ä½¿ç”¨ IP
    
    root /opt/meituan/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # API ä»£ç†ï¼ˆå¯é€‰ï¼‰
    location /api {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

3. **é‡å¯ Nginxï¼š**
```bash
nginx -t
nginx -s reload
```

#### é€‰é¡¹ Bï¼šä½¿ç”¨ç®€å•çš„ HTTP æœåŠ¡å™¨

```bash
# ä½¿ç”¨ Python çš„ HTTP æœåŠ¡å™¨
cd /opt/meituan/dist
python3 -m http.server 8081

# æˆ–ä½¿ç”¨ Node.js çš„ serve
npm install -g serve
serve -s dist -p 8081
```

### æ­¥éª¤ 4ï¼šè®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- æœ¬åœ°æµ‹è¯•ï¼š`http://localhost:8081`
- æœåŠ¡å™¨ï¼š`http://106.55.102.48:8081`

---

## ğŸ–¥ï¸ æ–¹å¼ 2ï¼šElectron æ¡Œé¢åº”ç”¨æ‰“åŒ…

### æ­¥éª¤ 1ï¼šè¿è¡Œæ‰“åŒ…è„šæœ¬

```bash
# Windows
build-electron.bat

# æˆ–æ‰‹åŠ¨æ‰§è¡Œ
cd meituan-frontend
npm install
npm run electron:build:win
```

### æ­¥éª¤ 2ï¼šæŸ¥æ‰¾å®‰è£…åŒ…

æ‰“åŒ…å®Œæˆåï¼Œåœ¨ `meituan-frontend/dist-electron` ç›®å½•æ‰¾åˆ°ï¼š

```
dist-electron/
â”œâ”€â”€ ç¾å›¢å•†å“ä¸Šä¼ å·¥å…·-1.0.0-x64.exe    # Windows å®‰è£…åŒ…
â””â”€â”€ ...
```

### æ­¥éª¤ 3ï¼šå®‰è£…å’Œä½¿ç”¨

1. åŒå‡» `.exe` æ–‡ä»¶
2. æŒ‰ç…§å®‰è£…å‘å¯¼å®Œæˆå®‰è£…
3. å¯åŠ¨åº”ç”¨å³å¯ä½¿ç”¨

### æ‰“åŒ…å…¶ä»–å¹³å°

**Mac ç‰ˆæœ¬ï¼š**
```bash
cd meituan-frontend
npm run electron:build:mac
```

**æ‰€æœ‰å¹³å°ï¼š**
```bash
cd meituan-frontend
npm run electron:build:all
```

---

## âš™ï¸ ç¯å¢ƒé…ç½®

### å¼€å‘ç¯å¢ƒ (.env.development)

```env
VITE_APP_ENV=development
VITE_API_BASE_URL=/api
```

- ä½¿ç”¨ Vite ä»£ç†ï¼Œé¿å… CORS é—®é¢˜
- é€‚åˆæœ¬åœ°å¼€å‘

### ç”Ÿäº§ç¯å¢ƒ (.env.production)

```env
VITE_APP_ENV=production
VITE_API_BASE_URL=http://106.55.102.48:8080
```

- ç›´æ¥è¿æ¥åç«¯ API
- é€‚åˆç”Ÿäº§éƒ¨ç½²

### ä¿®æ”¹ API åœ°å€

å¦‚æœéœ€è¦ä¿®æ”¹åç«¯ API åœ°å€ï¼š

1. ç¼–è¾‘ `meituan-frontend/.env.production`
2. ä¿®æ”¹ `VITE_API_BASE_URL` ä¸ºæ–°åœ°å€
3. é‡æ–°æ‰“åŒ…

---

## ğŸ” éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥å‰ç«¯èµ„æºåŠ è½½

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œæ£€æŸ¥ï¼š
- âœ… æ‰€æœ‰ JSã€CSS æ–‡ä»¶æ­£å¸¸åŠ è½½
- âœ… æ²¡æœ‰ 404 é”™è¯¯
- âœ… é¡µé¢æ­£å¸¸æ˜¾ç¤º

### 2. æµ‹è¯• API è¿æ¥

1. æ‰“å¼€ç™»å½•é¡µé¢
2. è¾“å…¥ç”¨æˆ·åå¯†ç ï¼ˆadmin/admin123ï¼‰
3. ç‚¹å‡»ç™»å½•
4. âœ… åº”è¯¥æˆåŠŸç™»å½•å¹¶è·³è½¬åˆ°ä¸»é¡µ

### 3. æµ‹è¯•åŠŸèƒ½

- âœ… å•†å“åˆ—è¡¨åŠ è½½
- âœ… ç³»ç»Ÿè®¾ç½®ä¿å­˜
- âœ… æ–‡ä»¶ä¸Šä¼ 
- âœ… æ¨¡æ¿ä¸‹è½½

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šAPI è¯·æ±‚å¤±è´¥ï¼ˆCORS é”™è¯¯ï¼‰

**åŸå› ï¼š** åç«¯æœªé…ç½® CORS æˆ–å‰ç«¯ API åœ°å€é”™è¯¯

**è§£å†³ï¼š**
1. æ£€æŸ¥ `.env.production` ä¸­çš„ `VITE_API_BASE_URL`
2. ç¡®ä¿åç«¯ `WebConfig.java` å·²é…ç½® CORS
3. æˆ–ä½¿ç”¨ Nginx ä»£ç†

### é—®é¢˜ 2ï¼šé¡µé¢åˆ·æ–°å 404

**åŸå› ï¼š** Web æœåŠ¡å™¨æœªé…ç½® SPA è·¯ç”±

**è§£å†³ï¼ˆNginxï¼‰ï¼š**
```nginx
location / {
    try_files $uri $uri/ /index.html;
}
```

### é—®é¢˜ 3ï¼šé™æ€èµ„æºåŠ è½½å¤±è´¥

**åŸå› ï¼š** èµ„æºè·¯å¾„é…ç½®é”™è¯¯

**è§£å†³ï¼š**
1. æ£€æŸ¥ `vite.config.js` ä¸­çš„ `base` é…ç½®
2. ç¡®ä¿ Nginx çš„ `root` è·¯å¾„æ­£ç¡®

### é—®é¢˜ 4ï¼šElectron æ‰“åŒ…å¤±è´¥

**åŸå› ï¼š** ä¾èµ–æœªå®‰è£…æˆ–ç½‘ç»œé—®é¢˜

**è§£å†³ï¼š**
```bash
# æ¸…é™¤ç¼“å­˜
cd meituan-frontend
rm -rf node_modules
rm package-lock.json

# é‡æ–°å®‰è£…
npm install

# ä½¿ç”¨å›½å†…é•œåƒ
npm config set registry https://registry.npmmirror.com
npm install
```

---

## ğŸ“¦ æ‰“åŒ…ä¼˜åŒ–

### å‡å°åŒ…ä½“ç§¯

1. **å¯ç”¨ä»£ç åˆ†å‰²ï¼š**
   - Vite è‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²
   - æŒ‰éœ€åŠ è½½è·¯ç”±ç»„ä»¶

2. **å‹ç¼©èµ„æºï¼š**
   - ç”Ÿäº§æ„å»ºè‡ªåŠ¨å‹ç¼© JSã€CSS
   - å›¾ç‰‡ä½¿ç”¨ WebP æ ¼å¼

3. **ç§»é™¤æœªä½¿ç”¨çš„ä»£ç ï¼š**
   - Tree-shaking è‡ªåŠ¨ç§»é™¤
   - æ£€æŸ¥å¹¶åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–

### æå‡åŠ è½½é€Ÿåº¦

1. **ä½¿ç”¨ CDNï¼š**
```html
<!-- åœ¨ index.html ä¸­å¼•å…¥ -->
<script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
<script src="https://cdn.jsdelivr.net/npm/element-plus"></script>
```

2. **å¯ç”¨ Gzipï¼š**
```nginx
gzip on;
gzip_types text/plain text/css application/json application/javascript;
```

3. **é…ç½®ç¼“å­˜ï¼š**
```nginx
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

### Web åº”ç”¨ï¼ˆå®Œæ•´æµç¨‹ï¼‰

```bash
# 1. æ‰“åŒ…å‰ç«¯
cd meituan-frontend
npm run build

# 2. å‹ç¼©å¹¶ä¸Šä¼ 
tar -czf dist.tar.gz dist/
scp dist.tar.gz root@106.55.102.48:/opt/meituan/

# 3. æœåŠ¡å™¨ç«¯è§£å‹
ssh root@106.55.102.48
cd /opt/meituan/
tar -xzf dist.tar.gz

# 4. é…ç½® Nginx å¹¶é‡å¯
nginx -s reload
```

### Electron åº”ç”¨

```bash
# 1. æ‰“åŒ…
cd meituan-frontend
npm run electron:build:win

# 2. æ‰¾åˆ°å®‰è£…åŒ…
cd dist-electron
# åŒå‡» .exe æ–‡ä»¶å®‰è£…
```

---

## ğŸ“Š æ„å»ºä¿¡æ¯

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ¡†æ¶ | Vue 3 + Vite |
| UI åº“ | Element Plus |
| çŠ¶æ€ç®¡ç† | Pinia |
| è·¯ç”± | Vue Router |
| æ¡Œé¢æ¡†æ¶ | Electron |
| æ„å»ºå·¥å…· | Vite + electron-builder |

---

## ğŸ“ æ”¯æŒä¿¡æ¯

### ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `build-frontend.bat` | Web åº”ç”¨æ‰“åŒ…è„šæœ¬ |
| `build-electron.bat` | Electron åº”ç”¨æ‰“åŒ…è„šæœ¬ |
| `.env.development` | å¼€å‘ç¯å¢ƒé…ç½® |
| `.env.production` | ç”Ÿäº§ç¯å¢ƒé…ç½® |
| `vite.config.js` | Vite æ„å»ºé…ç½® |
| `package.json` | é¡¹ç›®ä¾èµ–å’Œè„šæœ¬ |

### æ„å»ºè¾“å‡º

- **Web åº”ç”¨ï¼š** `meituan-frontend/dist/`
- **Electron åº”ç”¨ï¼š** `meituan-frontend/dist-electron/`

---

**å‡†å¤‡å°±ç»ªï¼ç°åœ¨å¯ä»¥å¼€å§‹æ‰“åŒ…å‰ç«¯äº†ã€‚** ğŸŠ

é€‰æ‹©ä½ éœ€è¦çš„æ–¹å¼ï¼š
1. è¿è¡Œ `build-frontend.bat` æ‰“åŒ… Web åº”ç”¨
2. è¿è¡Œ `build-electron.bat` æ‰“åŒ…æ¡Œé¢åº”ç”¨
